<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>QSabor A√ßa√≠ ‚Äî Painel Admin</title>
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Nunito:wght@400;600;700;800;900&display=swap" rel="stylesheet">
<style>
:root {
  --purple: #7B1FA2;
  --purple-dark: #4A0072;
  --purple-light: #CE93D8;
  --gold: #F9A825;
  --gold-light: #FFD54F;
  --dark: #0D0D0D;
  --dark2: #1a0a2e;
  --card: rgba(255,255,255,0.04);
  --border: rgba(255,255,255,0.1);
  --green: #43a047;
  --red: #e53935;
  --white: #FAFAFA;
}
* { margin:0; padding:0; box-sizing:border-box; }
body { font-family:'Nunito',sans-serif; background:var(--dark); color:var(--white); min-height:100vh; }

/* LOGIN */
#login-screen {
  min-height:100vh; display:flex; align-items:center; justify-content:center;
  background: radial-gradient(ellipse at 60% 30%, rgba(123,31,162,0.35) 0%, transparent 65%),
              radial-gradient(ellipse at 20% 80%, rgba(249,168,37,0.1) 0%, transparent 60%), var(--dark);
}
.login-box {
  background:rgba(255,255,255,0.04); border:1px solid rgba(123,31,162,0.4);
  border-radius:24px; padding:48px 40px; width:100%; max-width:420px;
  box-shadow:0 24px 64px rgba(0,0,0,0.5);
}
.login-logo { text-align:center; margin-bottom:32px; }
.login-logo h1 { font-family:'Bebas Neue',sans-serif; font-size:2.2rem; letter-spacing:2px; color:var(--gold); }
.login-logo p { color:var(--purple-light); font-size:0.85rem; margin-top:4px; }
.login-form label { display:block; font-weight:700; font-size:0.8rem; text-transform:uppercase; letter-spacing:1px; color:var(--purple-light); margin-bottom:8px; }
.login-form input {
  width:100%; background:rgba(255,255,255,0.05); border:1px solid var(--border);
  border-radius:10px; padding:14px 16px; color:var(--white); font-family:'Nunito',sans-serif;
  font-size:0.95rem; outline:none; transition:border-color 0.2s; margin-bottom:20px;
}
.login-form input:focus { border-color:var(--purple-light); }
.login-btn {
  width:100%; background:linear-gradient(135deg,var(--purple-dark),var(--purple));
  color:white; font-family:'Nunito',sans-serif; font-weight:900; font-size:1rem;
  padding:16px; border-radius:50px; border:none; cursor:pointer; transition:filter 0.2s;
  letter-spacing:0.5px;
}
.login-btn:hover { filter:brightness(1.2); }
.login-error { color:#ef5350; font-size:0.85rem; text-align:center; margin-top:12px; min-height:20px; }

/* ADMIN PANEL */
#admin-panel { display:none; min-height:100vh; }
.admin-header {
  position:sticky; top:0; z-index:100;
  background:rgba(10,0,20,0.95); backdrop-filter:blur(12px);
  border-bottom:1px solid rgba(249,168,37,0.2);
  padding:14px 32px; display:flex; align-items:center; justify-content:space-between;
}
.admin-header h1 { font-family:'Bebas Neue',sans-serif; font-size:1.6rem; letter-spacing:2px; color:var(--gold); }
.admin-header-right { display:flex; align-items:center; gap:16px; }
.user-badge { background:rgba(123,31,162,0.3); border:1px solid var(--purple-light); border-radius:50px; padding:6px 16px; font-size:0.8rem; font-weight:700; color:var(--purple-light); }
.logout-btn { background:rgba(229,57,53,0.15); border:1px solid #e53935; color:#ef9a9a; font-family:'Nunito',sans-serif; font-weight:700; font-size:0.8rem; padding:6px 16px; border-radius:50px; cursor:pointer; transition:all 0.2s; }
.logout-btn:hover { background:rgba(229,57,53,0.3); }

/* SIDEBAR + LAYOUT */
.admin-layout { display:flex; min-height:calc(100vh - 61px); }
.sidebar {
  width:220px; min-width:220px; background:rgba(255,255,255,0.02);
  border-right:1px solid var(--border); padding:24px 0;
}
.sidebar-item {
  display:flex; align-items:center; gap:12px;
  padding:13px 24px; cursor:pointer; font-weight:700; font-size:0.9rem;
  color:#888; transition:all 0.2s; border-left:3px solid transparent;
}
.sidebar-item:hover { color:var(--white); background:rgba(255,255,255,0.04); }
.sidebar-item.active { color:var(--gold); border-left-color:var(--gold); background:rgba(249,168,37,0.06); }
.sidebar-icon { font-size:1.1rem; }

.admin-content { flex:1; padding:32px; overflow-y:auto; }

/* TABS */
.tab-panel { display:none; animation:fadeIn 0.3s ease; }
.tab-panel.active { display:block; }
@keyframes fadeIn { from{opacity:0;transform:translateY(8px)} to{opacity:1;transform:translateY(0)} }

/* PAGE TITLE */
.page-title { font-family:'Bebas Neue',sans-serif; font-size:2rem; letter-spacing:2px; color:var(--gold); margin-bottom:6px; }
.page-sub { color:#888; font-size:0.9rem; margin-bottom:32px; }

/* CARDS */
.admin-card { background:var(--card); border:1px solid var(--border); border-radius:16px; padding:24px; margin-bottom:20px; }
.admin-card h3 { font-weight:900; font-size:1rem; margin-bottom:16px; color:var(--purple-light); text-transform:uppercase; letter-spacing:1px; }

/* STATUS TOGGLE */
.status-card { display:flex; align-items:center; justify-content:space-between; padding:20px 24px; background:var(--card); border:1px solid var(--border); border-radius:16px; margin-bottom:24px; }
.status-info h3 { font-weight:900; font-size:1.05rem; }
.status-info p { color:#888; font-size:0.85rem; margin-top:4px; }
.toggle-wrap { display:flex; align-items:center; gap:12px; }
.toggle-label { font-weight:800; font-size:0.9rem; }
.toggle {
  position:relative; width:56px; height:28px; background:#333;
  border-radius:50px; cursor:pointer; transition:background 0.3s;
}
.toggle.on { background:var(--green); }
.toggle::after {
  content:''; position:absolute; top:3px; left:3px;
  width:22px; height:22px; background:white; border-radius:50%;
  transition:transform 0.3s; box-shadow:0 2px 6px rgba(0,0,0,0.3);
}
.toggle.on::after { transform:translateX(28px); }

/* TABLES */
.data-table { width:100%; border-collapse:collapse; }
.data-table th { text-align:left; padding:10px 14px; font-size:0.75rem; text-transform:uppercase; letter-spacing:1px; color:#888; border-bottom:1px solid var(--border); }
.data-table td { padding:12px 14px; border-bottom:1px solid rgba(255,255,255,0.04); font-size:0.9rem; vertical-align:middle; }
.data-table tr:last-child td { border-bottom:none; }
.data-table tr:hover td { background:rgba(255,255,255,0.02); }

/* INLINE EDIT */
.inline-input {
  background:rgba(255,255,255,0.06); border:1px solid var(--border);
  border-radius:8px; padding:7px 12px; color:var(--white);
  font-family:'Nunito',sans-serif; font-size:0.9rem; width:100%;
  outline:none; transition:border-color 0.2s;
}
.inline-input:focus { border-color:var(--purple-light); }
.price-input { max-width:100px; }
.name-input { max-width:200px; }

/* BADGES */
.badge { display:inline-block; padding:3px 10px; border-radius:20px; font-size:0.7rem; font-weight:800; letter-spacing:0.5px; }
.badge-free { background:rgba(76,175,80,0.15); border:1px solid #4caf50; color:#81c784; }
.badge-paid { background:rgba(249,168,37,0.15); border:1px solid var(--gold); color:var(--gold); }
.badge-open { background:rgba(67,160,71,0.15); border:1px solid #43a047; color:#81c784; }
.badge-closed { background:rgba(229,57,53,0.15); border:1px solid #e53935; color:#ef9a9a; }

/* BUTTONS */
.btn-sm {
  padding:6px 14px; border-radius:8px; font-family:'Nunito',sans-serif;
  font-weight:700; font-size:0.8rem; cursor:pointer; border:none; transition:all 0.2s;
}
.btn-danger { background:rgba(229,57,53,0.15); border:1px solid #e53935; color:#ef9a9a; }
.btn-danger:hover { background:rgba(229,57,53,0.3); }
.btn-success { background:rgba(67,160,71,0.2); border:1px solid #43a047; color:#81c784; }
.btn-success:hover { background:rgba(67,160,71,0.35); }
.btn-primary-sm { background:linear-gradient(135deg,var(--purple-dark),var(--purple)); color:white; border:none; }
.btn-primary-sm:hover { filter:brightness(1.2); }
.btn-gold { background:linear-gradient(135deg,#b07800,var(--gold)); color:var(--dark); border:none; font-weight:900; }
.btn-gold:hover { filter:brightness(1.1); }

/* ADD FORM */
.add-form { display:flex; gap:12px; flex-wrap:wrap; align-items:flex-end; margin-top:16px; padding-top:16px; border-top:1px solid var(--border); }
.add-form .fg { display:flex; flex-direction:column; gap:6px; }
.add-form label { font-size:0.75rem; font-weight:700; text-transform:uppercase; letter-spacing:0.5px; color:var(--purple-light); }
.add-form input, .add-form select {
  background:rgba(255,255,255,0.06); border:1px solid var(--border);
  border-radius:8px; padding:9px 12px; color:var(--white);
  font-family:'Nunito',sans-serif; font-size:0.9rem; outline:none;
  transition:border-color 0.2s;
}
.add-form input:focus, .add-form select:focus { border-color:var(--purple-light); }
.add-form select option { background:#1a0030; }

/* SAVE BAR */
.save-bar {
  position:fixed; bottom:0; left:0; right:0;
  background:rgba(10,0,20,0.97); backdrop-filter:blur(12px);
  border-top:1px solid rgba(249,168,37,0.3);
  padding:16px 32px; display:flex; align-items:center; justify-content:space-between;
  transform:translateY(100%); transition:transform 0.3s;
  z-index:200;
}
.save-bar.show { transform:translateY(0); }
.save-bar p { color:var(--gold); font-weight:700; font-size:0.9rem; }
.save-btn {
  background:linear-gradient(135deg,var(--gold),var(--gold-light));
  color:var(--dark); font-family:'Nunito',sans-serif; font-weight:900;
  font-size:0.95rem; padding:12px 32px; border-radius:50px; border:none;
  cursor:pointer; transition:all 0.2s; box-shadow:0 4px 16px rgba(249,168,37,0.3);
}
.save-btn:hover { transform:translateY(-2px); }

/* TOAST */
.toast {
  position:fixed; top:80px; right:24px; z-index:999;
  background:var(--purple); color:white; padding:12px 20px;
  border-radius:10px; font-weight:700; font-size:0.85rem;
  transform:translateX(120%); opacity:0; transition:all 0.3s;
  border-left:3px solid var(--gold);
}
.toast.show { transform:translateX(0); opacity:1; }

/* USERS TABLE */
.user-role { display:inline-block; padding:3px 10px; border-radius:20px; font-size:0.7rem; font-weight:800; }
.role-admin { background:rgba(249,168,37,0.15); border:1px solid var(--gold); color:var(--gold); }
.role-colaborador { background:rgba(123,31,162,0.15); border:1px solid var(--purple-light); color:var(--purple-light); }

/* FORM GROUP */
.form-group { margin-bottom:16px; }
.form-group label { display:block; font-weight:700; font-size:0.8rem; text-transform:uppercase; letter-spacing:0.5px; color:var(--purple-light); margin-bottom:8px; }
.form-group input, .form-group select {
  width:100%; background:rgba(255,255,255,0.05); border:1px solid var(--border);
  border-radius:10px; padding:12px 14px; color:var(--white);
  font-family:'Nunito',sans-serif; font-size:0.9rem; outline:none; transition:border-color 0.2s;
}
.form-group input:focus, .form-group select:focus { border-color:var(--purple-light); }
.form-group select option { background:#1a0030; }
.form-row { display:grid; grid-template-columns:1fr 1fr; gap:16px; }

/* SCROLLBAR */
::-webkit-scrollbar { width:5px; }
::-webkit-scrollbar-track { background:var(--dark); }
::-webkit-scrollbar-thumb { background:var(--purple); border-radius:3px; }

@media(max-width:768px) {
  .sidebar { display:none; }
  .admin-content { padding:20px 16px; }
  .save-bar { padding:12px 16px; }
}
</style>
</head>
<body>

<!-- LOGIN SCREEN -->
<div id="login-screen">
  <div class="login-box">
    <div class="login-logo">
      <div style="font-size:2.5rem;margin-bottom:8px">ü´ê</div>
      <h1>QSABOR A√áA√ç</h1>
      <p>Painel Administrativo</p>
    </div>
    <div class="login-form">
      <label>Usu√°rio</label>
      <input type="text" id="login-user" placeholder="Digite seu usu√°rio" autocomplete="username">
      <label>Senha</label>
      <input type="password" id="login-pass" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" autocomplete="current-password" onkeydown="if(event.key==='Enter')doLogin()">
      <button class="login-btn" onclick="doLogin()">üîê Entrar</button>
      <div class="login-error" id="login-error"></div>
    </div>
  </div>
</div>

<!-- ADMIN PANEL -->
<div id="admin-panel">
  <div class="admin-header">
    <h1>‚öôÔ∏è QSABOR ‚Äî ADMIN</h1>
    <div class="admin-header-right">
      <div class="user-badge" id="user-badge">üë§ Admin</div>
      <button class="logout-btn" onclick="doLogout()">Sair</button>
    </div>
  </div>

  <div class="admin-layout">
    <!-- SIDEBAR -->
    <div class="sidebar">
      <div class="sidebar-item active" onclick="showTab('dashboard')"><span class="sidebar-icon">üìä</span> Dashboard</div>
      <div class="sidebar-item" onclick="showTab('loja')"><span class="sidebar-icon">üè™</span> Status da Loja</div>
      <div class="sidebar-item" onclick="showTab('tamanhos')"><span class="sidebar-icon">üìè</span> Tamanhos & Pre√ßos</div>
      <div class="sidebar-item" onclick="showTab('adicionais')"><span class="sidebar-icon">üçì</span> Adicionais</div>
      <div class="sidebar-item" onclick="showTab('info')"><span class="sidebar-icon">‚ÑπÔ∏è</span> Informa√ß√µes</div>
      <div class="sidebar-item" onclick="showTab('usuarios')"><span class="sidebar-icon">üë•</span> Usu√°rios</div>
    </div>

    <!-- CONTENT -->
    <div class="admin-content">

      <!-- DASHBOARD -->
      <div class="tab-panel active" id="tab-dashboard">
        <div class="page-title">Dashboard</div>
        <div class="page-sub">Vis√£o geral da loja</div>

        <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:16px;margin-bottom:28px">
          <div class="admin-card" style="text-align:center;padding:28px 16px">
            <div style="font-size:2rem;margin-bottom:8px">üè™</div>
            <div id="dash-status" style="font-size:1.1rem;font-weight:900;color:#81c784">ABERTA</div>
            <div style="font-size:0.8rem;color:#888;margin-top:4px">Status da Loja</div>
          </div>
          <div class="admin-card" style="text-align:center;padding:28px 16px">
            <div style="font-size:2rem;margin-bottom:8px">üìè</div>
            <div id="dash-sizes" style="font-size:1.8rem;font-weight:900;color:var(--gold)">7</div>
            <div style="font-size:0.8rem;color:#888;margin-top:4px">Tamanhos cadastrados</div>
          </div>
          <div class="admin-card" style="text-align:center;padding:28px 16px">
            <div style="font-size:2rem;margin-bottom:8px">üçì</div>
            <div id="dash-adds" style="font-size:1.8rem;font-weight:900;color:var(--gold)">23</div>
            <div style="font-size:0.8rem;color:#888;margin-top:4px">Adicionais cadastrados</div>
          </div>
          <div class="admin-card" style="text-align:center;padding:28px 16px">
            <div style="font-size:2rem;margin-bottom:8px">üë•</div>
            <div id="dash-users" style="font-size:1.8rem;font-weight:900;color:var(--gold)">-</div>
            <div style="font-size:0.8rem;color:#888;margin-top:4px">Usu√°rios</div>
          </div>
        </div>

        <div class="admin-card">
          <h3>üîó Link do Site</h3>
          <p style="color:#aaa;font-size:0.9rem;margin-bottom:12px">Compartilhe o link do card√°pio com seus clientes:</p>
          <div style="display:flex;gap:10px;align-items:center;flex-wrap:wrap">
            <input class="inline-input" id="site-link" value="https://fabricio1rdsantos-sudo.github.io/qsabor-acai" readonly style="flex:1;min-width:200px">
            <button class="btn-sm btn-gold" onclick="copyLink()">üìã Copiar</button>
            <a id="site-link-btn" href="https://fabricio1rdsantos-sudo.github.io/qsabor-acai" target="_blank"><button class="btn-sm btn-primary-sm">üåê Abrir Site</button></a>
          </div>
        </div>

        <div class="admin-card">
          <h3>‚ö° A√ß√µes R√°pidas</h3>
          <div style="display:flex;gap:12px;flex-wrap:wrap;margin-top:4px">
            <button class="btn-sm btn-success" onclick="showTab('loja')">üè™ Status da Loja</button>
            <button class="btn-sm btn-primary-sm" onclick="showTab('tamanhos')">üìè Editar Pre√ßos</button>
            <button class="btn-sm btn-primary-sm" onclick="showTab('adicionais')">üçì Gerenciar Adicionais</button>
            <button class="btn-sm btn-primary-sm" onclick="showTab('info')">‚ÑπÔ∏è Editar Informa√ß√µes</button>
          </div>
        </div>
      </div>

      <!-- STATUS DA LOJA -->
      <div class="tab-panel" id="tab-loja">
        <div class="page-title">Status da Loja</div>
        <div class="page-sub">Controle se a loja est√° aberta ou fechada para pedidos</div>

        <div class="status-card">
          <div class="status-info">
            <h3>üè™ Loja est√° <span id="store-status-label">Aberta</span></h3>
            <p id="store-status-desc">Clientes podem realizar pedidos normalmente.</p>
          </div>
          <div class="toggle-wrap">
            <span class="toggle-label" id="toggle-text" style="color:#81c784">ABERTA</span>
            <div class="toggle on" id="store-toggle" onclick="toggleStore()"></div>
          </div>
        </div>

        <div class="admin-card">
          <h3>üì¢ Mensagem para Clientes (quando fechada)</h3>
          <p style="color:#aaa;font-size:0.85rem;margin-bottom:12px">Esta mensagem aparece no site quando a loja estiver fechada.</p>
          <textarea id="closed-msg" rows="3" style="width:100%;background:rgba(255,255,255,0.05);border:1px solid var(--border);border-radius:10px;padding:12px 14px;color:var(--white);font-family:'Nunito',sans-serif;font-size:0.9rem;outline:none;resize:vertical" placeholder="Ex: Estamos fechados no momento. Voltamos √†s 14h!"></textarea>
          <div style="margin-top:12px">
            <button class="btn-sm btn-gold" onclick="saveLojaStatus()">üíæ Salvar</button>
          </div>
        </div>
      </div>

      <!-- TAMANHOS & PRE√áOS -->
      <div class="tab-panel" id="tab-tamanhos">
        <div class="page-title">Tamanhos & Pre√ßos</div>
        <div class="page-sub">Edite os tamanhos, nomes e pre√ßos dos produtos</div>

        <div class="admin-card">
          <h3>ü•§ Copos</h3>
          <table class="data-table" id="table-copos">
            <thead><tr><th>Tamanho</th><th>Pre√ßo (R$)</th><th>Ativo</th><th>A√ß√£o</th></tr></thead>
            <tbody id="tbody-copos"></tbody>
          </table>
          <div class="add-form">
            <div class="fg"><label>Tamanho</label><input type="text" id="new-copo-size" placeholder="Ex: 600ml" style="width:100px"></div>
            <div class="fg"><label>Pre√ßo (R$)</label><input type="number" id="new-copo-price" placeholder="0.00" step="0.50" min="0" style="width:100px"></div>
            <button class="btn-sm btn-gold" onclick="addSize('copo')">+ Adicionar</button>
          </div>
        </div>

        <div class="admin-card">
          <h3>üç± Marmitas</h3>
          <table class="data-table" id="table-marmitas">
            <thead><tr><th>Tamanho</th><th>Pre√ßo (R$)</th><th>Ativo</th><th>A√ß√£o</th></tr></thead>
            <tbody id="tbody-marmitas"></tbody>
          </table>
          <div class="add-form">
            <div class="fg"><label>Tamanho</label><input type="text" id="new-marmita-size" placeholder="Ex: 750ml" style="width:100px"></div>
            <div class="fg"><label>Pre√ßo (R$)</label><input type="number" id="new-marmita-price" placeholder="0.00" step="0.50" min="0" style="width:100px"></div>
            <button class="btn-sm btn-gold" onclick="addSize('marmita')">+ Adicionar</button>
          </div>
        </div>

        <div style="height:80px"></div>
      </div>

      <!-- ADICIONAIS -->
      <div class="tab-panel" id="tab-adicionais">
        <div class="page-title">Adicionais</div>
        <div class="page-sub">Gerencie os adicionais gr√°tis e pagos</div>

        <div class="admin-card">
          <h3>üü¢ Adicionais Gr√°tis</h3>
          <table class="data-table">
            <thead><tr><th>Nome</th><th>Ativo</th><th>A√ß√£o</th></tr></thead>
            <tbody id="tbody-free-adds"></tbody>
          </table>
          <div class="add-form">
            <div class="fg"><label>Nome</label><input type="text" id="new-free-name" placeholder="Ex: Pa√ßoca"></div>
            <button class="btn-sm btn-gold" onclick="addAdditional('free')">+ Adicionar</button>
          </div>
        </div>

        <div class="admin-card">
          <h3>üíõ Adicionais Pagos</h3>
          <table class="data-table">
            <thead><tr><th>Nome</th><th>Pre√ßo (R$)</th><th>Ativo</th><th>A√ß√£o</th></tr></thead>
            <tbody id="tbody-paid-adds"></tbody>
          </table>
          <div class="add-form">
            <div class="fg"><label>Nome</label><input type="text" id="new-paid-name" placeholder="Ex: Nutella"></div>
            <div class="fg"><label>Pre√ßo (R$)</label><input type="number" id="new-paid-price" placeholder="0.00" step="0.50" min="0" style="width:100px"></div>
            <button class="btn-sm btn-gold" onclick="addAdditional('paid')">+ Adicionar</button>
          </div>
        </div>

        <div style="height:80px"></div>
      </div>

      <!-- INFORMA√á√ïES -->
      <div class="tab-panel" id="tab-info">
        <div class="page-title">Informa√ß√µes da Loja</div>
        <div class="page-sub">Edite os dados exibidos no site</div>

        <div class="admin-card">
          <h3>üïê Hor√°rios de Funcionamento</h3>
          <div class="form-group"><label>Segunda a Sexta</label><input type="text" id="info-seg-sex" placeholder="14h √†s 22h"></div>
          <div class="form-group"><label>S√°bado</label><input type="text" id="info-sab" placeholder="13h √†s 23h"></div>
          <div class="form-group"><label>Domingo e Feriados</label><input type="text" id="info-dom" placeholder="13h √†s 22h"></div>
        </div>

        <div class="admin-card">
          <h3>üì± Contato & Entrega</h3>
          <div class="form-group"><label>WhatsApp</label><input type="text" id="info-whatsapp" placeholder="(65) 00000-0000"></div>
          <div class="form-group"><label>Instagram</label><input type="text" id="info-instagram" placeholder="@qsaboracai"></div>
          <div class="form-group"><label>Pedido M√≠nimo (R$)</label><input type="number" id="info-pedido-min" placeholder="12.00" step="0.50" min="0"></div>
          <div class="form-group"><label>Taxa de Entrega (a partir de R$)</label><input type="number" id="info-taxa" placeholder="3.00" step="0.50" min="0"></div>
          <div class="form-group"><label>Texto √Årea de Entrega</label><textarea id="info-area" rows="3" style="width:100%;background:rgba(255,255,255,0.05);border:1px solid var(--border);border-radius:10px;padding:12px 14px;color:var(--white);font-family:'Nunito',sans-serif;font-size:0.9rem;outline:none;resize:vertical"></textarea></div>
        </div>

        <div class="admin-card">
          <h3>ü´ê Sobre o A√ßa√≠</h3>
          <div class="form-group"><label>Texto descritivo</label><textarea id="info-sobre" rows="4" style="width:100%;background:rgba(255,255,255,0.05);border:1px solid var(--border);border-radius:10px;padding:12px 14px;color:var(--white);font-family:'Nunito',sans-serif;font-size:0.9rem;outline:none;resize:vertical"></textarea></div>
        </div>

        <div style="margin-top:8px;margin-bottom:80px">
          <button class="btn-sm btn-gold" style="padding:12px 28px;font-size:0.95rem" onclick="saveInfo()">üíæ Salvar Informa√ß√µes</button>
        </div>
      </div>

      <!-- USU√ÅRIOS -->
      <div class="tab-panel" id="tab-usuarios">
        <div class="page-title">Usu√°rios</div>
        <div class="page-sub">Gerencie os colaboradores com acesso ao painel</div>

        <div class="admin-card">
          <h3>üë• Usu√°rios Cadastrados</h3>
          <table class="data-table">
            <thead><tr><th>Usu√°rio</th><th>Perfil</th><th>A√ß√£o</th></tr></thead>
            <tbody id="tbody-users"></tbody>
          </table>
        </div>

        <div class="admin-card" id="add-user-card">
          <h3>‚ûï Adicionar Colaborador</h3>
          <div class="form-row">
            <div class="form-group"><label>Usu√°rio</label><input type="text" id="new-username" placeholder="nome_colaborador" autocomplete="off"></div>
            <div class="form-group"><label>Senha</label><input type="password" id="new-userpass" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" autocomplete="new-password"></div>
          </div>
          <div class="form-group" style="max-width:200px">
            <label>Perfil</label>
            <select id="new-userrole">
              <option value="colaborador">Colaborador</option>
              <option value="admin">Admin</option>
            </select>
          </div>
          <button class="btn-sm btn-gold" onclick="addUser()">+ Adicionar Usu√°rio</button>
        </div>

        <div style="height:40px"></div>
      </div>

    </div><!-- end admin-content -->
  </div><!-- end admin-layout -->
</div><!-- end admin-panel -->

<!-- SAVE BAR -->
<div class="save-bar" id="save-bar">
  <p>‚ö†Ô∏è Voc√™ tem altera√ß√µes n√£o salvas</p>
  <button class="save-btn" onclick="saveAllData()">üíæ Salvar Altera√ß√µes</button>
</div>

<div class="toast" id="toast"></div>

<script>
// =====================
// DEFAULT DATA
// =====================
const DEFAULT_DATA = {
  storeOpen: true,
  closedMsg: 'Estamos fechados no momento. Voltamos em breve!',
  copos: [
    {size:'300ml', price:12.00, active:true},
    {size:'400ml', price:15.00, active:true},
    {size:'500ml', price:18.00, active:true},
    {size:'700ml', price:22.00, active:true},
  ],
  marmitas: [
    {size:'300ml', price:13.00, active:true},
    {size:'500ml', price:19.00, active:true},
    {size:'1000ml', price:32.00, active:true},
  ],
  freeAdds: [
    {name:'Danone Morango', active:true},
    {name:'Leite Condensado', active:true},
    {name:'Maracuj√°', active:true},
    {name:'Leite em P√≥', active:true},
    {name:'Granola', active:true},
    {name:'Pa√ßoca', active:true},
    {name:'Ovomaltine', active:true},
    {name:'Confete', active:true},
    {name:'Sucrilhos', active:true},
    {name:'Aveia', active:true},
    {name:'Jujuba', active:true},
    {name:'Cobertura Chocolate', active:true},
    {name:'Cobertura Morango', active:true},
    {name:'Gotas de Chocolate', active:true},
    {name:'Chocoball', active:true},
    {name:'Uva', active:true},
    {name:'Banana', active:true},
  ],
  paidAdds: [
    {name:'Bis - Chocolate Branco', price:2.00, active:true},
    {name:'Bis - Chocolate Preto', price:2.00, active:true},
    {name:'Nutella', price:3.00, active:true},
    {name:'Kiwi', price:2.50, active:true},
    {name:'Ma√ß√£', price:2.00, active:true},
    {name:'Morango', price:3.00, active:true},
  ],
  info: {
    segSex: '14h √†s 22h',
    sab: '13h √†s 23h',
    dom: '13h √†s 22h',
    whatsapp: '(65) 9352-5542',
    instagram: '@qsaboracai',
    pedidoMin: 12.00,
    taxa: 3.00,
    area: 'Atendemos toda a regi√£o. Entre em contato pelo WhatsApp para confirmar se seu endere√ßo est√° dentro da nossa √°rea de cobertura.',
    sobre: 'Trabalhamos com polpa de a√ßa√≠ pura, sem conservantes e de qualidade premium vinda diretamente da Amaz√¥nia. Nosso a√ßa√≠ √© cremoso, encorpado e com aquele sabor inconfund√≠vel da fruta fresca.'
  }
};

const DEFAULT_USERS = [
  {username:'admin', password:'qsabor2024', role:'admin'}
];

// =====================
// STATE
// =====================
let appData = {};
let users = [];
let currentUser = null;
let hasChanges = false;

// =====================
// INIT
// =====================
function init() {
  const saved = localStorage.getItem('qsabor_data');
  appData = saved ? JSON.parse(saved) : JSON.parse(JSON.stringify(DEFAULT_DATA));
  const savedUsers = localStorage.getItem('qsabor_users');
  users = savedUsers ? JSON.parse(savedUsers) : JSON.parse(JSON.stringify(DEFAULT_USERS));
}

// =====================
// LOGIN
// =====================
function doLogin() {
  const u = document.getElementById('login-user').value.trim();
  const p = document.getElementById('login-pass').value;
  const user = users.find(x => x.username === u && x.password === p);
  if (!user) {
    document.getElementById('login-error').textContent = '‚ùå Usu√°rio ou senha incorretos.';
    document.getElementById('login-pass').value = '';
    return;
  }
  currentUser = user;
  document.getElementById('login-screen').style.display = 'none';
  document.getElementById('admin-panel').style.display = 'block';
  document.getElementById('user-badge').textContent = 'üë§ ' + user.username;
  // Hide add user card if not admin
  if (user.role !== 'admin') {
    document.getElementById('add-user-card').style.display = 'none';
  }
  renderAll();
}

function doLogout() {
  currentUser = null;
  document.getElementById('login-screen').style.display = 'flex';
  document.getElementById('admin-panel').style.display = 'none';
  document.getElementById('login-user').value = '';
  document.getElementById('login-pass').value = '';
  document.getElementById('login-error').textContent = '';
}

// =====================
// TABS
// =====================
function showTab(tab) {
  document.querySelectorAll('.tab-panel').forEach(p => p.classList.remove('active'));
  document.querySelectorAll('.sidebar-item').forEach(s => s.classList.remove('active'));
  document.getElementById('tab-' + tab).classList.add('active');
  const items = document.querySelectorAll('.sidebar-item');
  const tabs = ['dashboard','loja','tamanhos','adicionais','info','usuarios'];
  const idx = tabs.indexOf(tab);
  if (idx >= 0) items[idx].classList.add('active');
}

// =====================
// RENDER ALL
// =====================
function renderAll() {
  renderDashboard();
  renderLojaStatus();
  renderSizes();
  renderAdditionals();
  renderInfo();
  renderUsers();
}

function renderDashboard() {
  document.getElementById('dash-status').textContent = appData.storeOpen ? 'ABERTA' : 'FECHADA';
  document.getElementById('dash-status').style.color = appData.storeOpen ? '#81c784' : '#ef9a9a';
  document.getElementById('dash-sizes').textContent = appData.copos.filter(x=>x.active).length + appData.marmitas.filter(x=>x.active).length;
  document.getElementById('dash-adds').textContent = appData.freeAdds.filter(x=>x.active).length + appData.paidAdds.filter(x=>x.active).length;
  document.getElementById('dash-users').textContent = users.length;
}

function renderLojaStatus() {
  const open = appData.storeOpen;
  document.getElementById('store-status-label').textContent = open ? 'Aberta' : 'Fechada';
  document.getElementById('store-status-desc').textContent = open ? 'Clientes podem realizar pedidos normalmente.' : 'Pedidos pausados. Clientes ver√£o a mensagem de fechamento.';
  document.getElementById('toggle-text').textContent = open ? 'ABERTA' : 'FECHADA';
  document.getElementById('toggle-text').style.color = open ? '#81c784' : '#ef9a9a';
  const tog = document.getElementById('store-toggle');
  tog.classList.toggle('on', open);
  document.getElementById('closed-msg').value = appData.closedMsg || '';
}

function renderSizes() {
  renderSizeTable('copos', 'tbody-copos', 'copo');
  renderSizeTable('marmitas', 'tbody-marmitas', 'marmita');
}

function renderSizeTable(key, tbodyId, type) {
  const tbody = document.getElementById(tbodyId);
  tbody.innerHTML = '';
  appData[key].forEach((item, i) => {
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td><input class="inline-input name-input" value="${item.size}" onchange="updateSize('${key}',${i},'size',this.value)"></td>
      <td><input class="inline-input price-input" type="number" value="${item.price.toFixed(2)}" step="0.50" min="0" onchange="updateSize('${key}',${i},'price',parseFloat(this.value))"></td>
      <td><span class="badge ${item.active?'badge-open':'badge-closed'}" style="cursor:pointer" onclick="toggleSizeActive('${key}',${i})">${item.active?'Ativo':'Inativo'}</span></td>
      <td><button class="btn-sm btn-danger" onclick="removeSize('${key}',${i})">üóë Remover</button></td>`;
    tbody.appendChild(tr);
  });
}

function renderAdditionals() {
  const tbodyFree = document.getElementById('tbody-free-adds');
  tbodyFree.innerHTML = '';
  appData.freeAdds.forEach((item, i) => {
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td><input class="inline-input" value="${item.name}" onchange="updateAdd('freeAdds',${i},'name',this.value)"></td>
      <td><span class="badge ${item.active?'badge-open':'badge-closed'}" style="cursor:pointer" onclick="toggleAddActive('freeAdds',${i})">${item.active?'Ativo':'Inativo'}</span></td>
      <td><button class="btn-sm btn-danger" onclick="removeAdd('freeAdds',${i})">üóë</button></td>`;
    tbodyFree.appendChild(tr);
  });

  const tbodyPaid = document.getElementById('tbody-paid-adds');
  tbodyPaid.innerHTML = '';
  appData.paidAdds.forEach((item, i) => {
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td><input class="inline-input" value="${item.name}" onchange="updateAdd('paidAdds',${i},'name',this.value)"></td>
      <td><input class="inline-input price-input" type="number" value="${item.price.toFixed(2)}" step="0.50" min="0" onchange="updateAdd('paidAdds',${i},'price',parseFloat(this.value))"></td>
      <td><span class="badge ${item.active?'badge-open':'badge-closed'}" style="cursor:pointer" onclick="toggleAddActive('paidAdds',${i})">${item.active?'Ativo':'Inativo'}</span></td>
      <td><button class="btn-sm btn-danger" onclick="removeAdd('paidAdds',${i})">üóë</button></td>`;
    tbodyPaid.appendChild(tr);
  });
}

function renderInfo() {
  const info = appData.info;
  document.getElementById('info-seg-sex').value = info.segSex || '';
  document.getElementById('info-sab').value = info.sab || '';
  document.getElementById('info-dom').value = info.dom || '';
  document.getElementById('info-whatsapp').value = info.whatsapp || '';
  document.getElementById('info-instagram').value = info.instagram || '';
  document.getElementById('info-pedido-min').value = info.pedidoMin || '';
  document.getElementById('info-taxa').value = info.taxa || '';
  document.getElementById('info-area').value = info.area || '';
  document.getElementById('info-sobre').value = info.sobre || '';
}

function renderUsers() {
  const tbody = document.getElementById('tbody-users');
  tbody.innerHTML = '';
  users.forEach((u, i) => {
    const isMe = u.username === currentUser.username;
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td><strong>${u.username}</strong> ${isMe?'<span style="color:#888;font-size:0.75rem">(voc√™)</span>':''}</td>
      <td><span class="user-role ${u.role==='admin'?'role-admin':'role-colaborador'}">${u.role}</span></td>
      <td>${!isMe && currentUser.role==='admin' ? `<button class="btn-sm btn-danger" onclick="removeUser(${i})">üóë Remover</button>` : '-'}</td>`;
    tbody.appendChild(tr);
  });
  document.getElementById('dash-users').textContent = users.length;
}

// =====================
// ACTIONS
// =====================
function toggleStore() {
  appData.storeOpen = !appData.storeOpen;
  renderLojaStatus();
  renderDashboard();
  markChanges();
}

function saveLojaStatus() {
  appData.closedMsg = document.getElementById('closed-msg').value;
  saveAllData();
}

function updateSize(key, idx, field, val) {
  appData[key][idx][field] = val;
  markChanges();
}

function toggleSizeActive(key, idx) {
  appData[key][idx].active = !appData[key][idx].active;
  renderSizes();
  markChanges();
}

function removeSize(key, idx) {
  if (!confirm('Remover este tamanho?')) return;
  appData[key].splice(idx, 1);
  renderSizes();
  markChanges();
}

function addSize(type) {
  const sizeEl = document.getElementById(`new-${type}-size`);
  const priceEl = document.getElementById(`new-${type}-price`);
  const size = sizeEl.value.trim();
  const price = parseFloat(priceEl.value);
  if (!size) { showToast('‚ö†Ô∏è Informe o tamanho!'); return; }
  if (isNaN(price) || price <= 0) { showToast('‚ö†Ô∏è Informe um pre√ßo v√°lido!'); return; }
  const key = type === 'copo' ? 'copos' : 'marmitas';
  appData[key].push({size, price, active:true});
  sizeEl.value = ''; priceEl.value = '';
  renderSizes();
  markChanges();
  showToast('‚úÖ Tamanho adicionado!');
}

function updateAdd(key, idx, field, val) {
  appData[key][idx][field] = val;
  markChanges();
}

function toggleAddActive(key, idx) {
  appData[key][idx].active = !appData[key][idx].active;
  renderAdditionals();
  markChanges();
}

function removeAdd(key, idx) {
  if (!confirm('Remover este adicional?')) return;
  appData[key].splice(idx, 1);
  renderAdditionals();
  markChanges();
}

function addAdditional(type) {
  if (type === 'free') {
    const name = document.getElementById('new-free-name').value.trim();
    if (!name) { showToast('‚ö†Ô∏è Informe o nome!'); return; }
    appData.freeAdds.push({name, active:true});
    document.getElementById('new-free-name').value = '';
  } else {
    const name = document.getElementById('new-paid-name').value.trim();
    const price = parseFloat(document.getElementById('new-paid-price').value);
    if (!name) { showToast('‚ö†Ô∏è Informe o nome!'); return; }
    if (isNaN(price) || price <= 0) { showToast('‚ö†Ô∏è Informe um pre√ßo v√°lido!'); return; }
    appData.paidAdds.push({name, price, active:true});
    document.getElementById('new-paid-name').value = '';
    document.getElementById('new-paid-price').value = '';
  }
  renderAdditionals();
  markChanges();
  showToast('‚úÖ Adicional adicionado!');
}

function saveInfo() {
  appData.info = {
    segSex: document.getElementById('info-seg-sex').value,
    sab: document.getElementById('info-sab').value,
    dom: document.getElementById('info-dom').value,
    whatsapp: document.getElementById('info-whatsapp').value,
    instagram: document.getElementById('info-instagram').value,
    pedidoMin: parseFloat(document.getElementById('info-pedido-min').value) || 12,
    taxa: parseFloat(document.getElementById('info-taxa').value) || 3,
    area: document.getElementById('info-area').value,
    sobre: document.getElementById('info-sobre').value
  };
  saveAllData();
}

function addUser() {
  const username = document.getElementById('new-username').value.trim();
  const password = document.getElementById('new-userpass').value;
  const role = document.getElementById('new-userrole').value;
  if (!username) { showToast('‚ö†Ô∏è Informe o nome de usu√°rio!'); return; }
  if (!password || password.length < 4) { showToast('‚ö†Ô∏è Senha deve ter pelo menos 4 caracteres!'); return; }
  if (users.find(u => u.username === username)) { showToast('‚ö†Ô∏è Usu√°rio j√° existe!'); return; }
  users.push({username, password, role});
  localStorage.setItem('qsabor_users', JSON.stringify(users));
  document.getElementById('new-username').value = '';
  document.getElementById('new-userpass').value = '';
  renderUsers();
  showToast('‚úÖ Usu√°rio adicionado!');
}

function removeUser(idx) {
  if (!confirm('Remover este usu√°rio?')) return;
  users.splice(idx, 1);
  localStorage.setItem('qsabor_users', JSON.stringify(users));
  renderUsers();
  showToast('‚úÖ Usu√°rio removido!');
}

// =====================
// SAVE
// =====================
function markChanges() {
  hasChanges = true;
  document.getElementById('save-bar').classList.add('show');
}

function saveAllData() {
  localStorage.setItem('qsabor_data', JSON.stringify(appData));
  hasChanges = false;
  document.getElementById('save-bar').classList.remove('show');
  showToast('‚úÖ Altera√ß√µes salvas com sucesso!');
  renderDashboard();
}

// =====================
// UTILS
// =====================
function showToast(msg) {
  const t = document.getElementById('toast');
  t.textContent = msg;
  t.classList.add('show');
  setTimeout(() => t.classList.remove('show'), 2800);
}

function copyLink() {
  const val = document.getElementById('site-link').value;
  navigator.clipboard.writeText(val).then(() => showToast('‚úÖ Link copiado!'));
}

// Warn before leaving with unsaved changes
window.addEventListener('beforeunload', e => {
  if (hasChanges) { e.preventDefault(); e.returnValue = ''; }
});

// =====================
// START
// =====================
init();
</script>
</body>
</html>
